"use strict";var C=Object.create;var d=Object.defineProperty;var F=Object.getOwnPropertyDescriptor;var O=Object.getOwnPropertyNames;var j=Object.getPrototypeOf,T=Object.prototype.hasOwnProperty;var _=(t,e)=>{for(var s in e)d(t,s,{get:e[s],enumerable:!0})},P=(t,e,s,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of O(e))!T.call(t,n)&&n!==s&&d(t,n,{get:()=>e[n],enumerable:!(r=F(e,n))||r.enumerable});return t};var m=(t,e,s)=>(s=t!=null?C(j(t)):{},P(e||!t||!t.__esModule?d(s,"default",{value:t,enumerable:!0}):s,t)),v=t=>P(d({},"__esModule",{value:!0}),t);var D={};_(D,{default:()=>y});module.exports=v(D);var g=m(require("fs")),S=m(require("path")),h=require("webpack"),b=m(require("browser-extension-manifest-fields"));function x(t,e){return e.some(s=>t.includes(s))}var p=class{manifestPath;exclude;constructor(e){this.manifestPath=e.manifestPath,this.exclude=e.exclude}apply(e){e.hooks.thisCompilation.tap("Iconslugin (EmitFile)",s=>{s.hooks.processAssets.tap({name:"Iconslugin (EmitFile)",stage:h.Compilation.PROCESS_ASSETS_STAGE_OPTIMIZE_TRANSFER},()=>{if(s.errors.length>0)return;let r=(0,b.default)(this.manifestPath).icons;for(let n of Object.entries(r)){let[f,i]=n;if(i===void 0)continue;let o=Array.isArray(i)?typeof i[0]=="string"?i:i.map(Object.values).flat():[i];for(let a of o)if(a){if(!g.default.existsSync(a))continue;if(!x(a,this.exclude||[])){let c=g.default.readFileSync(a),u=new h.sources.RawSource(c),E=S.default.basename(a),k=`${f.endsWith("theme_icons")?f.replace("theme_icons",""):f}/${E}`;s.emitAsset(k,u)}}}})})}};var I=m(require("fs")),A=require("webpack"),w=m(require("browser-extension-manifest-fields")),l=class{manifestPath;exclude;constructor(e){this.manifestPath=e.manifestPath,this.exclude=e.exclude}apply(e){e.hooks.thisCompilation.tap("IconsPlugin (AddToFileDependencies)",s=>{s.hooks.processAssets.tap({name:"IconsPlugin (AddToFileDependencies)",stage:A.Compilation.PROCESS_ASSETS_STAGE_ADDITIONS},r=>{if(s.errors?.length)return;let n=r["manifest.json"]?JSON.parse(r["manifest.json"].source().toString()):require(this.manifestPath),f=(0,w.default)(this.manifestPath,n).icons;for(let i of Object.entries(f)){let[,o]=i,a=Array.isArray(o)?typeof o[0]=="string"?o:o.map(Object.values).flat():[o];for(let c of a)if(c){let u=new Set(s.fileDependencies);I.default.existsSync(c)&&(u.has(c)||(u.add(c),s.fileDependencies.add(c)))}}})})}};var y=class{manifestPath;exclude;constructor(e){this.manifestPath=e.manifestPath,this.exclude=e.exclude}apply(e){new p({manifestPath:this.manifestPath,exclude:this.exclude||[]}).apply(e),new l({manifestPath:this.manifestPath,exclude:this.exclude||[]}).apply(e)}};

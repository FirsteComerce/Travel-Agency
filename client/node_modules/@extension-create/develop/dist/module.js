"use strict";var wn=Object.create;var re=Object.defineProperty;var $n=Object.getOwnPropertyDescriptor;var bn=Object.getOwnPropertyNames;var Sn=Object.getPrototypeOf,Pn=Object.prototype.hasOwnProperty;var jn=(e,t)=>{for(var n in t)re(e,n,{get:t[n],enumerable:!0})},He=(e,t,n,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of bn(t))!Pn.call(e,s)&&s!==n&&re(e,s,{get:()=>t[s],enumerable:!(o=$n(t,s))||o.enumerable});return e};var r=(e,t,n)=>(n=e!=null?wn(Sn(e)):{},He(t||!e||!e.__esModule?re(n,"default",{value:e,enumerable:!0}):n,e)),kn=e=>He(re({},"__esModule",{value:!0}),e);var Zn={};jn(Zn,{extensionBuild:()=>Ze,extensionDev:()=>Me,extensionStart:()=>Ne});module.exports=kn(Zn);var an=r(require("fs")),ln=r(require("path")),y=require("@colors/colors/safe");var R=r(require("path")),Ke=r(require("go-git-it")),m=require("@colors/colors/safe");var ue=r(require("fs/promises")),me=r(require("path")),x=require("@colors/colors/safe"),Ge=r(require("axios")),Xe=r(require("adm-zip"));async function ge(e,t){let n=e.split("?")[0];try{let o=`\u{1F9E9} ${(0,x.bold)("Extension.js")} ${(0,x.green)("\u25BA\u25BA\u25BA")} Downloading extension from ${(0,x.bold)(n)}...`;console.log(o);let s=await(0,Ge.default)({url:e,method:"GET",responseType:"arraybuffer"}),i=me.default.basename(n),a=me.default.join(t,`${i}.zip`);await ue.default.writeFile(a,s.data),console.log(`\u{1F9E9} ${(0,x.bold)("Extension.js")} ${(0,x.green)("\u25BA\u25BA\u25BA")} Unpackaging browser extension from ${(0,x.white)((0,x.underline)(a))}`),new Xe.default(a).extractAllTo(t,!0),await ue.default.unlink(a),console.log(`\u{1F9E9} ${(0,x.bold)("Extension.js")} ${(0,x.green)("\u25BA\u25BA\u25BA")} Browser extension unpackaged successfully. Compiling...`)}catch(o){throw console.error(`Failed to download or extract ZIP file: ${o}`),o}}var Fn=e=>{try{return new URL(e),!0}catch{return!1}};async function En(e,t){return await(0,Ke.default)(e,process.cwd(),t),R.default.resolve(process.cwd(),R.default.basename(e))}async function Cn(e){return await ge(e,process.cwd()),e=e.split("?")[0],R.default.resolve(process.cwd(),R.default.basename(e))}async function B(e){if(!e)return process.cwd();if(Fn(e)){let t=new URL(e);if(t.protocol.startsWith("http")){if(t.origin!=="https://github.com")return await Cn(e);let n=t.pathname.split("/"),o=n.slice(1,3)[0],s=n.slice(1,3)[1],i=R.default.basename(t.pathname);console.log(`\u{1F9E9} ${(0,m.bold)("Extension.js")} ${(0,m.green)("\u25BA\u25BA\u25BA")} Fetching data from ${(0,m.blue)((0,m.underline)(`https://github.com/${o}/${s}`))}`);let a=`\u{1F9E9} ${(0,m.bold)("Extension.js")} ${(0,m.green)("\u25BA\u25BA\u25BA")} Downloading ${(0,m.bold)(i)}...`,c=await En(e,a);return console.log(`\u{1F9E9} ${(0,m.bold)("Extension.js")} ${(0,m.green)("\u25BA\u25BA\u25BA")} Creating a new browser extension in ${(0,m.white)((0,m.underline)(`${process.cwd()}/${i}`))}`),c}}return R.default.resolve(process.cwd(),e)}var V=r(require("path")),ae=r(require("fs"));var de=r(require("path")),Qe=r(require("fs")),I=require("@colors/colors/safe"),Ye=!1;function _(e){let t=de.default.join(e,"package.json"),n=de.default.join(e,"manifest.json"),o=require(n);if(!Qe.default.existsSync(t))return!1;let s=require(t),i=s.devDependencies&&s.devDependencies.react,a=s.dependencies&&s.dependencies.react;return(i||a)&&(Ye||(console.log((0,I.bold)(`\u{1F9E9} Extension.js ${(0,I.blue)("\u25BA\u25BA\u25BA")} ${o.name} (v${o.version}) `)+`is using ${(0,I.bold)((0,I.cyan)("React"))}.`),Ye=!0)),i||a}var $=require("@colors/colors/safe");var ye=r(require("path")),tt=r(require("fs")),A=require("@colors/colors/safe"),et=!1;function O(e){let t=ye.default.join(e,"package.json"),n=ye.default.join(e,"manifest.json"),o=require(n);if(!tt.default.existsSync(t))return!1;let s=require(t),i=s.devDependencies&&s.devDependencies.preact,a=s.dependencies&&s.dependencies.preact;return(i||a)&&(et||(console.log((0,A.bold)(`\u{1F9E9} Extension.js ${(0,A.blue)("\u25BA\u25BA\u25BA")} ${o.name} (v${o.version}) `)+`is using ${(0,A.bold)((0,A.cyan)("Preact"))}.`),et=!0)),i||a}function Tn(e,t){return{compilerOptions:{allowJs:!0,allowSyntheticDefaultImports:!0,esModuleInterop:!0,forceConsistentCasingInFileNames:!0,jsx:_(e)||O(e)?"react-jsx":"preserve",lib:["dom","dom.iterable","esnext"],moduleResolution:"node",module:"esnext",resolveJsonModule:!0,strict:!0,target:"esnext",isolatedModules:!1},exclude:["node_modules","dist"]}}function ot(e){let t=V.default.join(e,"tsconfig.json");if(ae.default.existsSync(t))return t}function zn(e,t){return{compilerOptions:{sourceMap:t.mode==="development",skipLibCheck:!0,inlineSourceMap:!1,declarationMap:!1,noEmit:!0,incremental:!0,tsBuildInfoFile:V.default.join("./","node_modules",".cache","tsbuildinfo")},exclude:["node_modules","dist"]}}function Dn(e){ae.default.writeFileSync(V.default.join(e,"tsconfig.json"),JSON.stringify(Tn(e,{mode:"development"}),null,2))}var nt=!1;function b(e){let t=V.default.join(e,"package.json");if(!ae.default.existsSync(t))return!1;let n=ot(e),o=require(t),s=require(V.default.join(e,"manifest.json")),i=o.devDependencies&&o.devDependencies.typescript,a=o.dependencies&&o.dependencies.typescript;return nt||((i||a)&&(n?console.log((0,$.bold)(`\u{1F9E9} Extension.js ${(0,$.blue)("\u25BA\u25BA\u25BA")} ${s.name} (v${s.version}) `)+`is using ${(0,$.bold)((0,$.blue)("TypeScript"))} config file.`):(console.log((0,$.bold)(`\u{1F9E9} Extension.js ${(0,$.blue)("\u25BA\u25BA\u25BA")} ${s.name} (v${s.version}) `)+`is using ${(0,$.bold)((0,$.blue)("TypeScript"))} but no config file was found. Creating ${(0,$.yellow)("tsconfig.json")}...`),Dn(e))),nt=!0),!!n&&!!(i||a)}function st(e,t){return{async:t.mode==="development",typescript:{context:e,configFile:ot(e),configOverwrite:zn(e,{mode:"development"}),typescriptPath:require.resolve("typescript",{paths:[e]}),profile:!1},logger:{log:()=>{},error:console.error}}}var xe=r(require("path")),he=r(require("fs/promises")),F=require("@colors/colors/safe");async function Y(e){let t=xe.default.join(e,"extension-env.d.ts"),n=process.env.EXTENSION_ENV==="development"?"../../programs/develop/types":"@extension-create/develop/dist/types",o=`// Required Extension.js types for TypeScript projects.
// This file is auto-generated and should not be excluded.
// If you need extra types, consider creating a new *.d.ts and
// referencing it in the "include" array in your tsconfig.json file.
// See https://www.typescriptlang.org/tsconfig#include for info.
/// <reference types="${n}/index.d.ts" />

// Polyfill types for browser.* APIs.
/// <reference types="${n}/polyfill.d.ts" />
`,s=require(xe.default.join(e,"manifest.json"));try{await he.default.access(t),console.log((0,F.bold)(`\u{1F9E9} Extension.js ${(0,F.blue)("\u25BA\u25BA\u25BA")} ${s.name} (v${s.version}) `)+`${(0,F.yellow)("extension-env.d.ts")} already exists.`)}catch{console.log((0,F.bold)(`\u{1F9E9} Extension.js ${(0,F.blue)("\u25BA\u25BA\u25BA")} ${s.name} (v${s.version}) `)+`${(0,F.blue)((0,F.bold)("TypeScript"))} install detected. Writing extension type definitions...`);try{await he.default.writeFile(t,o)}catch(a){console.log("\u{1F534} - Failed to write the extension type definition.",a)}}}var sn=r(require("webpack")),rn=r(require("webpack-dev-server"));var pt=r(require("path"));var le=r(require("path"));function ce(e){return le.default.join(e,"public")}function it(e){return le.default.join(e,"pages")}function rt(e){return le.default.join(e,"scripts")}function at(){return{errors:!1,warnings:!1}}var ve=r(require("path")),ct=r(require("fs")),M=require("@colors/colors/safe"),lt=!1;function Z(e){let t=ve.default.join(e,"package.json"),n=ve.default.join(e,"manifest.json"),o=require(n);if(!ct.default.existsSync(t))return!1;let s=require(t),i=s.devDependencies&&s.devDependencies.vue,a=s.dependencies&&s.dependencies.vue;return(i||a)&&(lt||(console.log((0,M.bold)(`\u{1F9E9} Extension.js ${(0,M.blue)("\u25BA\u25BA\u25BA")} ${o.name} (v${o.version}) `)+`is using ${(0,M.bold)((0,M.cyan)("Vue"))}.`),lt=!0)),i||a}function we(e,{port:t}){return{host:"127.0.0.1",allowedHosts:"all",static:ce(e),compress:!0,devMiddleware:{writeToDisk:!0},watchFiles:_(e)||Z(e)||O(e)?void 0:[pt.default.join(e,"**/*.html")],client:{logging:process.env.EXTENSION_ENV==="development"?"error":"none",progress:!1,overlay:at()},headers:{"Access-Control-Allow-Origin":"*"},port:"auto",hot:"only"}}var pe=r(require("path"));function ft(e){return pe.default.resolve(e,"manifest.json")}function H(e,t){let n=`dist/${t||"chrome"}`;return pe.default.join(e,n)}function ut(e){return"/"}function mt(e){return["node_modules",pe.default.join(e,"node_modules")]}function $e(e){return[".js",".mjs",".jsx",".mjsx",...b(e)?[".ts",".mts",".tsx",".mtsx"]:[]]}function gt(e){return[...$e(e),".json",".wasm"]}function dt(e){return O(e)?{react:"preact/compat","react-dom/test-utils":"preact/test-utils","react-dom":"preact/compat","react/jsx-runtime":"preact/jsx-runtime"}:void 0}var On=[{test:/\.(png|jpg|jpeg|gif|webp|avif|ico|bmp|svg)$/i,type:"asset/resource",parser:{dataUrlCondition:{maxSize:2048}}},{test:/\.(woff|woff2|eot|ttf|otf)$/i,type:"asset/resource"},{test:/\.(txt|md|csv|tsv|xml|pdf|docx|doc|xls|xlsx|ppt|pptx|zip|gz|gzip|tgz)$/i,type:"asset/resource",parser:{dataUrlCondition:{maxSize:2048}}},{test:/\.(csv|tsv)$/i,use:["csv-loader"]}],yt=On;var be=r(require("path")),xt=r(require("fs")),N=require("@colors/colors/safe"),fe=r(require("babel-preset-modern-browser-extension")),Ln=["babel.config.json","babel.config.js"];function qn(e){let t=require(be.default.join(e,"manifest.json"));for(let n of Ln){let o=be.default.join(e,n);if(xt.default.existsSync(o))return console.log((0,N.bold)(`\u{1F9E9} Extension.js ${(0,N.blue)("\u25BA\u25BA\u25BA")} ${t.name} (v${t.version}) `)+`is using ${(0,N.bold)((0,N.yellow)("Babel"))} config file.`),o}}function ht(e,t){return{cacheDirectory:!1,cacheCompression:!1,babelrc:!1,configFile:qn(e),compact:t.mode==="production",overrides:[(0,fe.default)(t).overrides],presets:[...(0,fe.default)(t).presets],plugins:[...(0,fe.default)(t).plugins,process.env.NODE_ENV!=="test"&&t.mode==="development"&&require.resolve("react-refresh/babel")].filter(Boolean)}}var Rn=e=>{let t=[{test:/\.vue$/,loader:require.resolve("vue-loader")}];return b(e)&&t.push({test:/\.ts?$/,loader:require.resolve("ts-loader"),options:{appendTsSuffixTo:[/\.vue$/],transpileOnly:!0}}),t};function Se(e,t){let o=[{test:b(e)?/\.(js|mjs|jsx|mjsx|ts|mts|tsx|mtsx)$/:/\.(js|mjs|jsx|mjsx)$/,include:e,exclude:/node_modules/,loader:require.resolve("babel-loader"),options:ht(e,{mode:t.mode,typescript:b(e)})}];return Z(e)&&o.push(...Rn(e)),o}var $t=r(require("mini-css-extract-plugin"));var G=r(require("path")),Q=r(require("fs")),U=require("@colors/colors");function Bn(e){let t=G.default.join(e,"tailwind.config.mjs"),n=G.default.join(e,"tailwind.config.cjs"),o=G.default.join(e,"tailwind.config.js");if(Q.default.existsSync(t))return t;if(Q.default.existsSync(n))return n;if(Q.default.existsSync(o))return o}var vt=!1;function wt(e){let t=G.default.join(e,"package.json"),n=G.default.join(e,"manifest.json");if(!Q.default.existsSync(t))return!1;let o=Bn(e),s=require(t),i=s.devDependencies&&s.devDependencies.tailwindcss,a=s.dependencies&&s.dependencies.tailwindcss,c=require(n),l=!!o&&!!(i||a);return l&&(vt||(console.log((0,U.bold)(`\u{1F9E9} Extension.js ${(0,U.blue)("\u25BA\u25BA\u25BA")} ${c.name} (v${c.version}) `)+`is using ${(0,U.bold)((0,U.magenta)("Tailwind"))} config file.`),vt=!0)),l}function W(e,t){let n=[t.mode==="production"?$t.default.loader:require.resolve("style-loader"),require.resolve("css-loader"),{loader:require.resolve("postcss-loader"),options:{postcssOptions:{parser:require.resolve("postcss-scss"),ident:"postcss",config:!1,plugins:[...wt(e)?[require.resolve("tailwindcss",{paths:[e]})]:[],require.resolve("postcss-flexbugs-fixes"),[require.resolve("postcss-preset-env"),{autoprefixer:{flexbox:"no-2009"},stage:3}],require.resolve("postcss-normalize")].filter(Boolean)},sourceMap:!1}}];return t.loader&&n.push({loader:t.loader,options:{sourceMap:t.mode==="development"}}),n}function Pe(e,t){return[{test:/\.css$/,exclude:/\.module\.css$/,type:"javascript/auto",use:W(e,{regex:/\.css$/,mode:t.mode})},{test:/\.module\.css$/,type:"javascript/auto",use:W(e,{regex:/\.module\.css$/,mode:t.mode})},{test:/\.(scss|sass)$/,exclude:/\.module\.css$/,use:W(e,{regex:/\.module\.css$/,loader:require.resolve("sass-loader"),mode:t.mode})},{test:/\.module\.(scss|sass)$/,exclude:/\.module\.css$/,use:W(e,{regex:/\.module\.css$/,loader:require.resolve("sass-loader"),mode:t.mode})},{test:/\.less$/,exclude:/\.module\.css$/,use:W(e,{regex:/\.module\.css$/,loader:require.resolve("less-loader"),mode:t.mode})}]}var ke=r(require("path")),Pt=r(require("case-sensitive-paths-webpack-plugin")),jt=r(require("fork-ts-checker-webpack-plugin")),kt=r(require("stylelint-webpack-plugin")),Ft=require("vue-loader"),Et=r(require("mini-css-extract-plugin"));var h=r(require("path")),S=r(require("fs")),D=require("@colors/colors");function je(e){let t=h.default.join(e,"stylelint.config.js"),n=h.default.join(e,".stylelintrc.js file"),o=h.default.join(e,"stylelint.config.mjs"),s=h.default.join(e,".stylelintrc.mjs"),i=h.default.join(e,"stylelint.config.cjs"),a=h.default.join(e,".stylelintrc.cjs"),c=h.default.join(e,".stylelintrc.json"),l=h.default.join(e,".stylelintrc"),f=h.default.join(e,".stylelintrc.yml"),w=h.default.join(e,".stylelintrc.yaml");if(S.default.existsSync(t))return t;if(S.default.existsSync(n))return n;if(S.default.existsSync(o))return o;if(S.default.existsSync(s))return s;if(S.default.existsSync(i))return i;if(S.default.existsSync(a))return a;if(S.default.existsSync(c))return c;if(S.default.existsSync(l))return l;if(S.default.existsSync(f))return f;if(S.default.existsSync(w))return w}var bt=!1;function St(e){let t=h.default.join(e,"package.json"),n=h.default.join(e,"manifest.json");if(!S.default.existsSync(t))return!1;let o=je(e),s=require(t),i=s.devDependencies&&s.devDependencies.stylelint,a=s.dependencies&&s.dependencies.stylelint,c=require(n),l=!!o&&!!(i||a);return l&&(bt||(console.log((0,D.bold)(`\u{1F9E9} Extension.js ${(0,D.blue)("\u25BA\u25BA\u25BA")} ${c.name} (v${c.version}) `)+`is using ${(0,D.bgBlack)((0,D.bold)((0,D.white)("Stylelint")))} config file.`),bt=!0)),l}function Fe(e,t){return{constructor:{name:"CompilationPlugins"},apply:n=>{if(new Pt.default().apply(n),b(e)){let o=st(e,t);new jt.default(o).apply(n)}new kt.default({context:e,configFile:St(e)?je(e):ke.default.join(__dirname,"stylelint.config.js"),files:"**/*.{css,scss,sass,less}",exclude:["node_modules",ke.default.join(e,"node_modules")]}).apply(n),t.mode==="production"&&new Et.default({chunkFilename:o=>{let s=o.chunk?.runtime;if(s.startsWith("content_scripts")){let[,i]=s.split("/");return`web_accessible_resources/resource-${i.split("-")[1]}/[name].css`}return`${s}/[name].css`}}).apply(n),Z(e)&&new Ft.VueLoaderPlugin().apply(n)}}}var qt=r(require("path")),Rt=r(require("webpack-browser-extension-resolve")),Bt=r(require("webpack-browser-extension-manifest")),It=r(require("webpack-browser-extension-html")),At=r(require("webpack-browser-extension-scripts")),Mt=r(require("webpack-browser-extension-locales")),Nt=r(require("webpack-browser-extension-json")),Ut=r(require("webpack-browser-extension-icons")),Wt=r(require("webpack-browser-extension-resources"));var E=r(require("fs")),k=r(require("path"));function Ct(e){if(!E.default.existsSync(e)||!E.default.statSync(e).isDirectory())return[];let t=[];function n(o){let s=E.default.readdirSync(o,{withFileTypes:!0});for(let i of s){let a=k.default.join(o,i.name);i.isDirectory()?n(a):i.isFile()&&i.name.endsWith(".html")&&t.push(a)}}return n(e),t}function Tt(e,t){if(!E.default.existsSync(t)||!E.default.statSync(t).isDirectory())return[];let n=[];function o(s){let i=E.default.readdirSync(s,{withFileTypes:!0});for(let a of i){let c=k.default.extname(a.name),l=$e(e).includes(c),f=k.default.join(s,a.name);a.isDirectory()?o(f):a.isFile()&&l&&n.push(f)}}return o(t),n}function zt(e){if(!E.default.existsSync(e)||!E.default.statSync(e).isDirectory())return[];let t=[];function n(o){let s=E.default.readdirSync(o,{withFileTypes:!0});for(let i of s){let a=k.default.join(o,i.name);i.isDirectory()?n(a):i.isFile()&&t.push(a)}}return n(e),t}function Dt(e){return!e||!e.length?{}:e.reduce((t,n)=>{let o=k.default.extname(n),s=k.default.basename(n,o);return{...t,[`pages/${s}.html`]:n}},{})}function Ot(e){return!e||!e.length?{}:e.reduce((t,n)=>{let o=k.default.extname(n),s=k.default.basename(n,o);return{...t,[`scripts/${s}.js`]:n}},{})}function Lt(e,t){return!t||!t.length?{}:t.reduce((n,o)=>{let s=k.default.relative(e,o),i=k.default.normalize(s);return{...n,[i]:o}},{})}function Ee(e,{browser:t}){let n=qt.default.resolve(e,"manifest.json"),o=ce(e),s=it(e),i=rt(e),a=zt(o),c=Ct(s),l=Tt(e,i),f=Lt(e,a),w=Dt(c),z=Ot(l);return{constructor:{name:"ExtensionPlugin"},apply:j=>{new Rt.default({manifestPath:n,includeList:{...w,...z,...f}}).apply(j),new Bt.default({browser:t,manifestPath:n,exclude:a}).apply(j),new It.default({manifestPath:n,include:c,exclude:[...a,...l]}).apply(j),new At.default({manifestPath:n,include:l,exclude:[...a,...c]}).apply(j),new Mt.default({manifestPath:n}).apply(j),new Nt.default({manifestPath:n,exclude:a}).apply(j),new Ut.default({manifestPath:n,exclude:a}).apply(j),new Wt.default({manifestPath:n,exclude:a}).apply(j)}}}var Jt=r(require("@pmmmwh/react-refresh-webpack-plugin"));function Ce(e,{mode:t}){return{constructor:{name:"ReloadPlugins"},apply:n=>{t==="development"&&(_(e)||O(e))&&new Jt.default().apply(n)}}}var _t=r(require("path")),Vt=r(require("webpack-browser-extension-polyfill")),Zt=r(require("webpack-browser-extension-manifest-compat"));function Te(e,{polyfill:t,browser:n}){return{constructor:{name:"CompatPlugin"},apply:o=>{let s=_t.default.resolve(e,"manifest.json");t&&n!=="firefox"&&new Vt.default({manifestPath:s,browser:n}).apply(o),new Zt.default({manifestPath:s,browser:n}).apply(o)}}}var Ht=r(require("path")),Gt=r(require("webpack-browser-extension-common-errors"));function ze(e,{mode:t,browser:n}){return{constructor:{name:"ErrorPlugin"},apply:o=>{let s=Ht.default.resolve(e,"manifest.json");new Gt.default({manifestPath:s}).apply(o)}}}var De=r(require("webpack-run-chrome-extension")),Xt=r(require("webpack-run-edge-extension")),Kt=r(require("webpack-run-firefox-addon"));function Oe(e,t){if(!t?.mode||process.env.NODE_ENV==="test")return{constructor:{name:"BrowserPlugin"},apply:()=>{}};let n={port:8e3,manifestPath:ft(e),extensionPath:H(e,t.browser),autoReload:!0,browserFlags:["--enable-benchmarking"],stats:!0},o={...n,port:8001,stats:!0},s={...n,port:8002,stats:!0};return{constructor:{name:"BrowserPlugin"},apply:i=>{switch(t.browser){case"chrome":new De.default(n).apply(i);break;case"edge":new Xt.default(o).apply(i);break;case"firefox":new Kt.default(s).apply(i);break;default:new De.default(n).apply(i);break}}}}var L=r(require("fs")),P=r(require("path")),T=r(require("@colors/colors/safe")),tn=r(require("dotenv-webpack"));var Le=r(require("fs")),Yt=r(require("path")),ee=class{apply(t){let n=Yt.default.join(t.options.output.path||"","hot");Le.default.existsSync(n)&&(Le.default.rmSync(n,{recursive:!0,force:!0}),process.env.EXTENSION_ENV==="development"&&console.log("[CleanHotUpdatesPlugin] Removed old hot-update files before compilation."))}};var g=r(require("fs")),d=r(require("path")),Qt=r(require("chokidar")),te=class{options;constructor(t){this.options=t}ensureDirectoryExistence(t){let n=d.default.dirname(t);if(g.default.existsSync(n))return!0;g.default.mkdirSync(n,{recursive:!0})}copyFile(t,n){this.ensureDirectoryExistence(n),g.default.copyFileSync(t,n)}copyFolder(t,n){g.default.existsSync(n)||g.default.mkdirSync(n,{recursive:!0}),g.default.readdirSync(t).forEach(s=>{let i=d.default.join(t,s),a=d.default.join(n,s);g.default.statSync(i).isDirectory()?this.copyFolder(i,a):this.copyFile(i,a)})}apply(t){let n=d.default.dirname(this.options.manifestPath),o=d.default.join(n,"public"),s=t.options.output?.path||"";g.default.existsSync(o)&&(t.hooks.afterEmit.tap("CopyStaticFolder",()=>{let i=d.default.join(s,"public");g.default.existsSync(i)||g.default.mkdirSync(i,{recursive:!0}),g.default.existsSync(o)&&this.copyFolder(o,i)}),t.options.mode!=="production"&&t.hooks.afterPlugins.tap("WatchPagesPlugin",()=>{let i=d.default.join(n,"public"),a=Qt.default.watch(i,{ignoreInitial:!0});a.on("add",c=>{let l=d.default.join(s,d.default.relative(n,c));this.copyFile(c,l)}),a.on("change",c=>{let l=d.default.join(s,d.default.relative(n,c));this.copyFile(c,l)}),a.on("unlink",c=>{let l=d.default.join(s,d.default.relative(n,c));g.default.existsSync(l)&&g.default.unlinkSync(l)}),t.hooks.watchClose.tap("WatchPagesPlugin",()=>{a.close().catch(console.error)})}))}};var C=r(require("path")),qe=r(require("chokidar")),J=require("@colors/colors/safe"),Re=class{manifestPath;constructor(t){this.manifestPath=t}throwCompilationError(t,n,o){let s=C.relative(process.cwd(),n),i=o?"Adding":"Removing",a=o?"added":"removed",c=t==="pages"?"HTML pages":"script files",l=`
\u{1F9E9} ${(0,J.bold)("Extension.js")} ${(0,J.red)("\u2716\uFE0E\u2716\uFE0E\u2716\uFE0E")} ${i} ${c} in the ${(0,J.underline)(t+"/")} folder after compilation requires a server restart.

- File ${a}: ${(0,J.underline)(s)}

Restart the program to apply changes.`;if(o){console.warn(l);return}console.error(l),process.exit(1)}apply(t){t.hooks.afterPlugins.tap("WatchPagesPlugin",()=>{let n=C.dirname(this.manifestPath),o=C.join(n,"pages"),s=C.join(n,"scripts"),i=qe.watch(o,{ignoreInitial:!0}),a=qe.watch(s,{ignoreInitial:!0}),c=t.options.resolve?.extensions;i.on("add",l=>{l.endsWith(".html")&&this.throwCompilationError("pages",l,!0)}),i.on("unlink",l=>{l.endsWith(".html")&&this.throwCompilationError("pages",l)}),a.on("add",l=>{c?.includes(C.extname(l))&&this.throwCompilationError("scripts",l,!0)}),a.on("unlink",l=>{c?.includes(C.extname(l))&&this.throwCompilationError("scripts",l)}),t.hooks.watchClose.tap("WatchPagesPlugin",()=>{i.close().catch(console.error),a.close().catch(console.error)})})}},en=Re;var ne=class{options;constructor(t){this.options=t}apply(t){let{manifestPath:n}=this.options;new te({manifestPath:n}).apply(t),t.options.mode==="development"&&t.options.watchOptions&&new en(n).apply(t)}};function Be(e,{mode:t}){let n=require(`${e}/manifest.json`),o=n.name,s=n.version;return{constructor:{name:"BoringPlugin"},apply:i=>{i.hooks.done.tap("BoringPlugin",a=>{let c=a.hasErrors()?T.default.red("\u2716\uFE0E\u2716\uFE0E\u2716\uFE0E"):T.default.green("\u25BA\u25BA\u25BA");a.compilation.name=`\u{1F9E9} Extension.js ${c} ${o} (v${s})`}),new ne({manifestPath:P.default.join(e,"manifest.json")}).apply(i),(L.default.existsSync(P.default.join(e,".env"))||L.default.existsSync(P.default.join(e,".env.example"))||L.default.existsSync(P.default.join(e,".env.local"))||L.default.existsSync(P.default.join(e,".env.defaults")))&&(console.log((0,T.bold)(`\u{1F9E9} Extension.js ${(0,T.blue)("\u25BA\u25BA\u25BA")} ${o} (v${s}) `)+`${(0,T.bold)((0,T.yellow)("env"))} file loaded.`),new tn.default({path:L.default.existsSync(P.default.join(e,".env"))?P.default.join(e,".env"):L.default.existsSync(P.default.join(e,".env.local"))?P.default.join(e,".env.local"):P.default.join(e,".env.example"),allowEmptyValues:!0,defaults:L.default.existsSync(P.default.join(e,".env.defaults")),systemvars:!0}).apply(i)),new ee().apply(i)}}}var nn=r(require("fs"));function Ie(e){let t=`${e}/manifest.json`;return nn.default.lstatSync(t)||(console.log("\u{1F6A8} - Error while developing the extension: manifest.json not found"),process.exit(1)),require(t).manifest_version===3?"cheap-source-map":"eval-cheap-source-map"}var Qo=process.env.EXTENSION_ENV==="development";function on(){return{children:!0,errorDetails:!0,entrypoints:!1,colors:!0,assets:!1,chunks:!1,modules:!1}}function oe(e,{...t}){return{mode:t.mode,entry:{},target:"web",context:e,devtool:Ie(e),stats:on(),infrastructureLogging:{level:"none"},cache:!1,performance:{hints:!1,maxAssetSize:999e3,maxEntrypointSize:999e3},output:{clean:{keep(n){return!n.startsWith("hot/background")}},path:H(e,t.browser),publicPath:ut(e),hotUpdateChunkFilename:"hot/[id].[fullhash].hot-update.js",hotUpdateMainFilename:"hot/[runtime].[fullhash].hot-update.json",environment:{bigIntLiteral:!0,dynamicImport:!0},chunkFilename:n=>{let o=n.chunk?.runtime;if(o.startsWith("content_scripts")){let[,s]=o.split("/");return`web_accessible_resources/resource-${s.split("-")[1]}/[name].js`}return`${o}/[name].js`}},resolve:{mainFields:["browser","module","main"],alias:dt(e),modules:mt(e),extensions:gt(e)},watchOptions:{ignored:/node_modules|dist/},module:{rules:[...Se(e,t),...Pe(e,t),...yt]},plugins:[Fe(e,t),Ee(e,t),Ce(e,t),Oe(e,t),Te(e,t),ze(e,t),Be(e,t)],optimization:{minimize:t.mode==="production"},experiments:{css:!0,asyncWebAssembly:!0}}}function Ae(e){e.stop().then(()=>{process.exit()}).catch(t=>{console.log(`Error in the Extension.js runner: ${t.stack||""}`)})}async function se(e,{...t}){let n=oe(e,t),o=we(e,t),s=(0,sn.default)(n),i=new rn.default(o,s);i.startCallback(a=>{a!=null&&console.log(`Error in the Extension.js runner: ${a.stack||""}`)}),process.on("ERROR",()=>{Ae(i)}),process.on("SIGINT",()=>{Ae(i)}),process.on("SIGTERM",()=>{Ae(i)})}async function Me(e,{...t}={mode:"development"}){let n=await B(e);!e?.startsWith("http")&&!an.default.existsSync(ln.default.join(n,"manifest.json"))&&(console.log(`\u{1F9E9} ${(0,y.bold)("Extension.js")} ${(0,y.red)("\u2716\uFE0E\u2716\uFE0E\u2716\uFE0E")} Manifest file ${(0,y.red)((0,y.bold)("not found"))}. Path ${(0,y.underline)(n)} must include a ${(0,y.yellow)("manifest.json")}.`),process.exit(1));try{b(n)&&await Y(n),await se(n,{...t})}catch(o){console.log(`\u{1F9E9} ${(0,y.bold)("Extension.js")} ${(0,y.red)("\u2716\uFE0E\u2716\uFE0E\u2716\uFE0E")} Error while developing the extension:

${(0,y.red)((0,y.bold)(o||""))}`),process.exit(1)}}var X=require("@colors/colors/safe");async function Ne(e,{...t}={mode:"production"}){let n=await B(e);try{b(n)&&await Y(n),await se(n,{...t})}catch(o){console.log(`\u{1F9E9} ${(0,X.bold)("Extension.js")} ${(0,X.red)("\u2716\uFE0E\u2716\uFE0E\u2716\uFE0E")} Error while developing the extension:

${(0,X.red)((0,X.bold)(o||""))}`),process.exit(1)}}var K=require("@colors/colors/safe");var mn=r(require("webpack")),Je=r(require("path")),gn=r(require("fs")),v=require("console"),u=require("@colors/colors/safe");var q=r(require("path")),p=require("@colors/colors/safe"),Ue=r(require("adm-zip")),cn=r(require("slugify")),pn=r(require("fs")),fn=r(require("ignore")),un=require("glob");function In(e){try{return pn.default.readFileSync(e,"utf8")}catch{return""}}function An(e){return(0,cn.default)(e,{replacement:"-",remove:/[^a-zA-Z0-9 ]/g,lower:!0})}function Mn(e){switch(e){case"opera":return"crx";case"firefox":return"xpi";default:return"zip"}}function Nn(e,t){let n=An(t.zipFilename||e.name);return t.zipFilename?n:`${n}-${e.version}`}function Un(e){return e.charAt(0).toUpperCase()+e.slice(1)}function Wn(e){let t=q.default.join(e,".gitignore"),n=In(t),o=(0,fn.default)();return n?o.add(n):console.log(`No ${(0,p.yellow)(".gitignore")} found, zipping all the content inside ${(0,p.underline)(e)}`),un.glob.sync("**/*",{cwd:e,dot:!0,nodir:!0}).filter(i=>!o.ignores(i))}function We(e,{browser:t="chrome",...n}){try{let o=q.default.join(e,"dist",t),s=n.zipSource?e:o,i=require(q.default.join(s,"manifest.json")),a=Nn(i,n),c=Mn(t),l=q.default.join(o,`${a}.${c}`),f=q.default.join(o,`${a}-source.${c}`),w=Un(t);if(n.zipSource){console.log(`
Packaging source files to ${(0,p.white)((0,p.underline)(f))}. Files in ${(0,p.yellow)(".gitignore")} will be excluded...`);let z=new Ue.default;Wn(e).forEach(ie=>{z.addLocalFile(q.default.join(e,ie),q.default.dirname(ie))}),z.writeZip(f)}if(n.zip){console.log(`
Packaging extension distribution files to ${(0,p.white)((0,p.underline)(l))}...`);let z=new Ue.default;z.addLocalFolder(o),z.writeZip(l)}n.zip&&n.zipSource?console.log(`
${(0,p.bold)("\u{1F4E6} Package name:")} ${(0,p.yellow)(`${a}`)}, ${(0,p.bold)("Target Browser:")} ${`${w}`}
   ${(0,p.bold)("\u2514\u2500")} ${(0,p.underline)(`${f}`)} (source)
   ${(0,p.bold)("\u2514\u2500")} ${(0,p.underline)(`${l}`)} (distribution)`):n.zip?console.log(`
${(0,p.bold)("\u{1F4E6} Package name:")} ${(0,p.yellow)(`${a}.${c}`)}, ${(0,p.bold)("Target Browser:")} ${`${w}`}
   ${(0,p.bold)("\u2514\u2500")} ${(0,p.underline)(`${l}`)} (distribution)`):n.zipSource&&console.log(`
${(0,p.bold)("\u{1F4E6} Package name:")} ${(0,p.yellow)(`${a}-source.${c}`)}, ${(0,p.bold)("Target Browser:")} ${`${w}`}
   ${(0,p.bold)("\u2514\u2500")} ${(0,p.underline)(`${f}`)} (source)`)}catch(o){throw console.error(`\u{1F9E9} ${(0,p.bold)("Extension.js")} ${(0,p.blue)("\u2716\uFE0E\u2716\uFE0E\u2716\uFE0E")} Failed to compress extension package: ${o}`),o}}function _e(e){return`${(e/1024).toFixed(2)}KB`}function dn(e,t=""){Object.keys(e).forEach((n,o,s)=>{let i=o===s.length-1,a=i?"\u2514\u2500":"\u251C\u2500",c=e[n].size?` (${_e(e[n].size)})`:"";(0,v.log)(`${t}${a} ${(0,u.bold)(n)}${c}`),typeof e[n]=="object"&&!e[n].size&&dn(e[n],`${t}${i?"   ":"|  "}`)})}function Jn(e,t){(0,v.log)(`
`),t?.forEach(n=>{let o=_e(n.size);(0,v.log)(`\u2022 ${(0,u.bold)("Filename:")} ${(0,u.yellow)(n.name)}, ${(0,u.bold)("Size:")} ${o}
  ${(0,u.bold)("\u2514\u2500")} ${(0,u.underline)(`${Je.default.join(e,n.name)}`)}`)})}function _n(e){let t={};e?.forEach(n=>{let o=n.name.split("/"),s=t;o.forEach((i,a)=>{s[i]||(s[i]={}),a===o.length-1?s[i]={size:n.size}:s=s[i]})}),(0,v.log)("."),dn(t)}function Vn(e){let t=0;return e?.forEach(n=>{t+=n.size}),_e(t)}function Ve(e,t){let n=t.browser||"chrome",o=oe(e,{mode:"production",browser:n}),s={...o,infrastructureLogging:{level:"info"},plugins:o.plugins?.filter(i=>i?.constructor.name!=="BrowserPlugin")};(0,mn.default)(s).run((i,a)=>{i&&((0,v.error)(i.stack||i),process.exit(1));let c=a?.toJson(),l=Je.default.join(e,"manifest.json"),f=JSON.parse(gn.default.readFileSync(l,"utf8")),w=c?.assets,z=s.output?.path||H(e,n),j=`\u{1F9E9} ${(0,u.bold)("Extension.js")} ${(0,u.green)("\u25BA\u25BA\u25BA")} Building ${(0,u.bold)(f.name)} extension using ${(0,u.bold)(n)} defaults...
`,ie=`
Build completed in ${((c?.time||0)/1e3).toFixed(2)} seconds.`,yn=`Build Status: ${a?.hasErrors()?(0,u.red)("Failed"):(0,u.green)("Success")}`,xn=`Version: ${f.version}`,hn=`Size: ${Vn(w)}`,vn=(0,u.green)(`
No errors or warnings found. Your extension is ready for deployment.`);(0,v.log)(j),_n(w),Jn(z,w),(0,v.log)(ie),(0,v.log)(yn),(0,v.log)(xn),(0,v.log)(hn),(t.zip||t.zipSource)&&We(e,{...t,browser:n}),a?.hasErrors()?(console.log(a.toString({colors:!0})),process.exit(1)):(0,v.log)(vn)})}async function Ze(e,{...t}){let n=await B(e);try{Ve(n,{...t})}catch(o){console.log(`\u{1F9E9} ${(0,K.bold)("Extension.js")} ${(0,K.red)("\u2716\uFE0E\u2716\uFE0E\u2716\uFE0E")} Error while developing the extension:

${(0,K.red)((0,K.bold)(o||""))}`),process.exit(1)}}0&&(module.exports={extensionBuild,extensionDev,extensionStart});
